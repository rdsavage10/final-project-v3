<body>

<div class="container text-center">
  <div class="">
      <h2><%= @room.name %></h2>
  </div>

  <div>

    <div class="card flex-center py-4">
      <p><%= @room.description %></p>
      <p><%= @action.join(" ") %></p>
    </div>


    <ul class="d-flex justify-content-center">   <!-- Items in room -->
      <% @room_data[@room.id].each do |item_id|  %>
          <div class="card">
            <% if !@inventory.include? (item_id) %>
              <%= @items[item_id][:name]  %> <%= link_to "Pickup", pickup_path(id: @room[:id], item_id: item_id), method: :post, class: "btn btn-sm btn-success" %>
            <% else %>
              <br><%= @items[item_id][:name]  %> (max # in inventory)
            <% end %>
              <br><button type="button" class="btn btn-secondary btn-sm" data-container="body" data-toggle="popover" data-placement="bottom" data-content="<%= @items[item_id][:description]%>">Info</button>
          </div>
      <% end %>
    </ul>

    <p class="justify-content-center">                                          <!-- Path buttons -->
    <% @paths.each_with_index do |path, index| %>
      <% if path[:require] == nil || (@inventory.include? path[:require])  %>
        <% if @chance[index] == true %>
            <%= link_to path[:text] + " #{path[:chance]}% chance (test:pass)", current_room_path(id:path[:main_path]), class: 'btn btn-primary' %>
        <% elsif @chance[index] == false %>
            <%= link_to path[:text] + " #{path[:chance]}% chance (test:fail)", current_room_path(id:path[:chance_path]), class: 'btn btn-primary' %>
        <% elsif @chance[index] = "pass" %>
          <%= link_to path[:text], current_room_path(id:path[:main_path]), class: 'btn btn-primary' %>
        <% end %>
      <% else %>
        <%= link_to path[:text] + " (Locked, requires #{@items[path[:require]].name})", current_room_path(id:path[:main_path]) , class: 'disabled btn btn-secondary' %>
      <% end %>
    <% end %>
    </p>


    <ul>                                         <!-- Items in inventory -->
      <% if @paths.length > 0 %>
        <strong>In your inventory you find:</strong>
        <div class="d-flex justify-content-center">
          <% @inventory.each do |item_id| %>
                <p  class="card mx-2"><%= @items[item_id][:name] %>
                  <% if !@room_data[@room.id].include? (item_id) %>
                    <%= link_to "Drop", drop_path(id: @room[:id], item_id: item_id), method: :post, class: "btn btn-warning btn-sm" %>
                  <% else %>
                    <br>
                    (max # in room)
                  <% end %>
                  <br>
                  <a tabindex="0" class="btn btn-sm btn-info" role="button" data-toggle="popover" data-trigger="focus" data-placement="bottom" title="<%= @items[item_id][:name] %>" data-content="<%= @items[item_id][:description]%>">Info</a>
                </p>
          <% end %>
        </div>
      <% end %>
    </ul>

  </div>
</div>
</body>

<footer class="fixed">                                <!-- Main menu escape -->
  <%= link_to "Main menu", start_menu_path, class: "btn btn-danger m-1"%>
</footer>
